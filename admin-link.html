<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="noindex,nofollow" />
  <title>Admin Link | Astro Kabuto</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    main.wrap{ padding-top:16px; }
    .panel{
      background: rgba(255,255,255,.75);
      border: 1px solid rgba(0,0,0,.10);
      border-radius: 18px;
      padding: 14px;
      box-shadow: 0 18px 55px rgba(0,0,0,.08);
      max-width: 860px;
      margin: 0 auto;
    }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    input[type="password"]{
      height:44px; border-radius:14px; border:1px solid rgba(0,0,0,.12);
      padding:0 12px; min-width: 320px; flex: 1;
      background:#fff;
    }
    button{
      height:44px; border-radius:14px; border:1px solid rgba(0,0,0,.12);
      background:#fff; padding:0 14px; cursor:pointer; font-weight:900;
    }
    button.primary{ background: rgba(0,113,227,.12); border-color: rgba(0,113,227,.18); }
    .hint{ color: rgba(0,0,0,.55); font-size: 12px; margin-top: 10px; line-height: 1.6; }
    .ok{ color: rgba(0,70,160,.92); font-weight: 900; }
    .ng{ color: rgba(140,20,12,.92); font-weight: 900; }
  </style>
</head>

<body>
  <main class="wrap">
    <div class="panel">
      <h1 style="margin:0 0 8px;">Admin Token 保存</h1>
      <p class="hint" style="margin:0 0 12px;">
        URLにtokenは出しません。ここで保存して <b>admin.html</b> を開きます（Bearerで送信）。
      </p>

      <div class="row">
        <input id="token" type="password" inputmode="text" autocomplete="off" placeholder="ADMIN_TOKEN を貼り付け" />
        <button class="primary" id="save">保存して管理画面へ</button>
        <button id="open">管理画面を開く</button>
        <button id="clear">削除</button>
      </div>

      <p id="status" class="hint"></p>

      <p class="hint">
        ※PC共有・画面共有・スクショに注意。保存を消したい時は「削除」。<br/>
        ※ブラウザを変えると保存は引き継がれません（その方が安全）。
      </p>
    </div>
  </main>

<script>
  const KEY = "AK_ADMIN_TOKEN";

  const elToken  = document.getElementById("token");
  const elStatus = document.getElementById("status");

  function setStatus(msg, ok=true){
    elStatus.innerHTML = ok ? `<span class="ok">${msg}</span>` : `<span class="ng">${msg}</span>`;
  }

  function load(){
    const t = localStorage.getItem(KEY) || "";
    if(t) setStatus("保存済み（tokenは表示しません）");
    else setStatus("未保存です", false);
  }

  document.getElementById("save").addEventListener("click", ()=>{
    const t = (elToken.value || "").trim();
    if(!t){ setStatus("tokenが空です", false); return; }
    localStorage.setItem(KEY, t);
    elToken.value = ""; // 画面に残さない
    setStatus("保存しました。管理画面を開きます");
    location.href = "admin.html";
  });

  document.getElementById("open").addEventListener("click", ()=>{
    location.href = "admin.html";
  });

  document.getElementById("clear").addEventListener("click", ()=>{
    localStorage.removeItem(KEY);
    elToken.value = "";
    setStatus("削除しました", true);
  });

  load();
</script>
</body>
</html>

